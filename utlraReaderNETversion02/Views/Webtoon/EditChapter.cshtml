@model utlraReaderNETversion02.Models.ViewModels.EditChapterViewModel

@{
    ViewData["Title"] = "Bölüm Düzenle";
    Layout = "_Layout";
}

<div class="container mt-5">
    <h2>@Model.WebtoonName - '@Model.ChapterName' Bölümünü Düzenle</h2>

    @* Validasyon özetini göster *@
    <div asp-validation-summary="All" class="text-danger"></div>

    <form asp-action="EditChapter" method="post" enctype="multipart/form-data">
        <input type="hidden" asp-for="WebtoonName" />
        <input type="hidden" asp-for="ChapterName" />

        <div class="mb-3">
            <label asp-for="NewChapterName" class="form-label">
                Bölüm Adı (Güncellemek isterseniz)
            </label>
            <input asp-for="NewChapterName" class="form-control" placeholder="Yeni bölüm adı (opsiyonel)" />
            <span asp-validation-for="NewChapterName" class="text-danger"></span>
        </div>

        <div class="mb-3">
            <label class="form-label">Mevcut Görseller</label>
            <table class="table table-bordered">
                <thead>
                    <tr>
                        <th>Görsel</th>
                        <th>Eski Ad</th>
                        <th>Yeni Ad</th>
                        <th>Sil</th>
                    </tr>
                </thead>
                <tbody>
                    @for (int i = 0; i < Model.ExistingImages.Count; i++)
                    {
                        <tr>
                            <td>
                                <img src="@Url.Content($"~/webtoons/{Model.WebtoonName}/{Model.ChapterName}/{Model.ExistingImages[i].FileName}")" width="80" class="img-thumbnail" />
                                <!-- Gizli inputlar: Bu değerler form gönderildiğinde korunur -->
                                <input type="hidden" asp-for="ExistingImages[@i].FileName" />
                            </td>
                            <td>
                                @Html.DisplayFor(m => m.ExistingImages[i].FileName)
                            </td>
                            <td>
                                <input asp-for="ExistingImages[@i].NewName" class="form-control" />
                                <span asp-validation-for="ExistingImages[@i].NewName" class="text-danger"></span>
                            </td>
                            <td class="text-center">
                                <input type="checkbox" asp-for="ExistingImages[@i].Delete" class="form-check-input" />
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>

        <div class="mb-3">
            <label asp-for="NewImages" class="form-label">Yeni Görseller Ekle</label>
            <input asp-for="NewImages" type="file" multiple class="form-control" />
            <span asp-validation-for="NewImages" class="text-danger"></span>
        </div>

        <button type="submit" class="btn btn-success">Kaydet</button>
    </form>
</div>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
}
